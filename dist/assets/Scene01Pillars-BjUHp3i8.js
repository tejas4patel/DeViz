import{t as G,d as Q,r as L,s as C,j as I}from"./index-CktA7uae.js";import{u as W}from"./useResizeObserver-B4Hlj4Qd.js";function X(t,e){var n,l=1;t==null&&(t=0),e==null&&(e=0);function a(){var o,f=n.length,p,y=0,s=0;for(o=0;o<f;++o)p=n[o],y+=p.x,s+=p.y;for(y=(y/f-t)*l,s=(s/f-e)*l,o=0;o<f;++o)p=n[o],p.x-=y,p.y-=s}return a.initialize=function(o){n=o},a.x=function(o){return arguments.length?(t=+o,a):t},a.y=function(o){return arguments.length?(e=+o,a):e},a.strength=function(o){return arguments.length?(l=+o,a):l},a}function Y(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return U(this.cover(e,n),e,n,t)}function U(t,e,n,l){if(isNaN(e)||isNaN(n))return t;var a,o=t._root,f={data:l},p=t._x0,y=t._y0,s=t._x1,d=t._y1,m,x,c,_,u,i,h,g;if(!o)return t._root=f,t;for(;o.length;)if((u=e>=(m=(p+s)/2))?p=m:s=m,(i=n>=(x=(y+d)/2))?y=x:d=x,a=o,!(o=o[h=i<<1|u]))return a[h]=f,t;if(c=+t._x.call(null,o.data),_=+t._y.call(null,o.data),e===c&&n===_)return f.next=o,a?a[h]=f:t._root=f,t;do a=a?a[h]=new Array(4):t._root=new Array(4),(u=e>=(m=(p+s)/2))?p=m:s=m,(i=n>=(x=(y+d)/2))?y=x:d=x;while((h=i<<1|u)===(g=(_>=x)<<1|c>=m));return a[g]=o,a[h]=f,t}function V(t){var e,n,l=t.length,a,o,f=new Array(l),p=new Array(l),y=1/0,s=1/0,d=-1/0,m=-1/0;for(n=0;n<l;++n)isNaN(a=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(f[n]=a,p[n]=o,a<y&&(y=a),a>d&&(d=a),o<s&&(s=o),o>m&&(m=o));if(y>d||s>m)return this;for(this.cover(y,s).cover(d,m),n=0;n<l;++n)U(this,f[n],p[n],t[n]);return this}function Z(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,l=this._y0,a=this._x1,o=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,o=(l=Math.floor(e))+1;else{for(var f=a-n||1,p=this._root,y,s;n>t||t>=a||l>e||e>=o;)switch(s=(e<l)<<1|t<n,y=new Array(4),y[s]=p,p=y,f*=2,s){case 0:a=n+f,o=l+f;break;case 1:n=a-f,o=l+f;break;case 2:a=n+f,l=o-f;break;case 3:n=a-f,l=o-f;break}this._root&&this._root.length&&(this._root=p)}return this._x0=n,this._y0=l,this._x1=a,this._y1=o,this}function J(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function K(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function E(t,e,n,l,a){this.node=t,this.x0=e,this.y0=n,this.x1=l,this.y1=a}function q(t,e,n){var l,a=this._x0,o=this._y0,f,p,y,s,d=this._x1,m=this._y1,x=[],c=this._root,_,u;for(c&&x.push(new E(c,a,o,d,m)),n==null?n=1/0:(a=t-n,o=e-n,d=t+n,m=e+n,n*=n);_=x.pop();)if(!(!(c=_.node)||(f=_.x0)>d||(p=_.y0)>m||(y=_.x1)<a||(s=_.y1)<o))if(c.length){var i=(f+y)/2,h=(p+s)/2;x.push(new E(c[3],i,h,y,s),new E(c[2],f,h,i,s),new E(c[1],i,p,y,h),new E(c[0],f,p,i,h)),(u=(e>=h)<<1|t>=i)&&(_=x[x.length-1],x[x.length-1]=x[x.length-1-u],x[x.length-1-u]=_)}else{var g=t-+this._x.call(null,c.data),w=e-+this._y.call(null,c.data),r=g*g+w*w;if(r<n){var v=Math.sqrt(n=r);a=t-v,o=e-v,d=t+v,m=e+v,l=c.data}}return l}function tt(t){if(isNaN(d=+this._x.call(null,t))||isNaN(m=+this._y.call(null,t)))return this;var e,n=this._root,l,a,o,f=this._x0,p=this._y0,y=this._x1,s=this._y1,d,m,x,c,_,u,i,h;if(!n)return this;if(n.length)for(;;){if((_=d>=(x=(f+y)/2))?f=x:y=x,(u=m>=(c=(p+s)/2))?p=c:s=c,e=n,!(n=n[i=u<<1|_]))return this;if(!n.length)break;(e[i+1&3]||e[i+2&3]||e[i+3&3])&&(l=e,h=i)}for(;n.data!==t;)if(a=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,a?(o?a.next=o:delete a.next,this):e?(o?e[i]=o:delete e[i],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(l?l[h]=n:this._root=n),this):(this._root=o,this)}function et(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function nt(){return this._root}function rt(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function it(t){var e=[],n,l=this._root,a,o,f,p,y;for(l&&e.push(new E(l,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(l=n.node,o=n.x0,f=n.y0,p=n.x1,y=n.y1)&&l.length){var s=(o+p)/2,d=(f+y)/2;(a=l[3])&&e.push(new E(a,s,d,p,y)),(a=l[2])&&e.push(new E(a,o,d,s,y)),(a=l[1])&&e.push(new E(a,s,f,p,d)),(a=l[0])&&e.push(new E(a,o,f,s,d))}return this}function at(t){var e=[],n=[],l;for(this._root&&e.push(new E(this._root,this._x0,this._y0,this._x1,this._y1));l=e.pop();){var a=l.node;if(a.length){var o,f=l.x0,p=l.y0,y=l.x1,s=l.y1,d=(f+y)/2,m=(p+s)/2;(o=a[0])&&e.push(new E(o,f,p,d,m)),(o=a[1])&&e.push(new E(o,d,p,y,m)),(o=a[2])&&e.push(new E(o,f,m,d,s)),(o=a[3])&&e.push(new E(o,d,m,y,s))}n.push(l)}for(;l=n.pop();)t(l.node,l.x0,l.y0,l.x1,l.y1);return this}function ot(t){return t[0]}function st(t){return arguments.length?(this._x=t,this):this._x}function lt(t){return t[1]}function ut(t){return arguments.length?(this._y=t,this):this._y}function R(t,e,n){var l=new S(e??ot,n??lt,NaN,NaN,NaN,NaN);return t==null?l:l.addAll(t)}function S(t,e,n,l,a,o){this._x=t,this._y=e,this._x0=n,this._y0=l,this._x1=a,this._y1=o,this._root=void 0}function H(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var $=R.prototype=S.prototype;$.copy=function(){var t=new S(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,l;if(!e)return t;if(!e.length)return t._root=H(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var a=0;a<4;++a)(l=e.source[a])&&(l.length?n.push({source:l,target:e.target[a]=new Array(4)}):e.target[a]=H(l));return t};$.add=Y;$.addAll=V;$.cover=Z;$.data=J;$.extent=K;$.find=q;$.remove=tt;$.removeAll=et;$.root=nt;$.size=rt;$.visit=it;$.visitAfter=at;$.x=st;$.y=ut;function B(t){return function(){return t}}function z(t){return(t()-.5)*1e-6}function ft(t){return t.x+t.vx}function ct(t){return t.y+t.vy}function ht(t){var e,n,l,a=1,o=1;typeof t!="function"&&(t=B(t==null?1:+t));function f(){for(var s,d=e.length,m,x,c,_,u,i,h=0;h<o;++h)for(m=R(e,ft,ct).visitAfter(p),s=0;s<d;++s)x=e[s],u=n[x.index],i=u*u,c=x.x+x.vx,_=x.y+x.vy,m.visit(g);function g(w,r,v,N,A){var b=w.data,k=w.r,M=u+k;if(b){if(b.index>x.index){var j=c-b.x-b.vx,D=_-b.y-b.vy,F=j*j+D*D;F<M*M&&(j===0&&(j=z(l),F+=j*j),D===0&&(D=z(l),F+=D*D),F=(M-(F=Math.sqrt(F)))/F*a,x.vx+=(j*=F)*(M=(k*=k)/(i+k)),x.vy+=(D*=F)*M,b.vx-=j*(M=1-M),b.vy-=D*M)}return}return r>c+M||N<c-M||v>_+M||A<_-M}}function p(s){if(s.data)return s.r=n[s.data.index];for(var d=s.r=0;d<4;++d)s[d]&&s[d].r>s.r&&(s.r=s[d].r)}function y(){if(e){var s,d=e.length,m;for(n=new Array(d),s=0;s<d;++s)m=e[s],n[m.index]=+t(m,s,e)}}return f.initialize=function(s,d){e=s,l=d,y()},f.iterations=function(s){return arguments.length?(o=+s,f):o},f.strength=function(s){return arguments.length?(a=+s,f):a},f.radius=function(s){return arguments.length?(t=typeof s=="function"?s:B(+s),y(),f):t},f}function pt(t){return t.index}function P(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function gt(t){var e=pt,n=m,l,a=B(30),o,f,p,y,s,d=1;t==null&&(t=[]);function m(i){return 1/Math.min(p[i.source.index],p[i.target.index])}function x(i){for(var h=0,g=t.length;h<d;++h)for(var w=0,r,v,N,A,b,k,M;w<g;++w)r=t[w],v=r.source,N=r.target,A=N.x+N.vx-v.x-v.vx||z(s),b=N.y+N.vy-v.y-v.vy||z(s),k=Math.sqrt(A*A+b*b),k=(k-o[w])/k*i*l[w],A*=k,b*=k,N.vx-=A*(M=y[w]),N.vy-=b*M,v.vx+=A*(M=1-M),v.vy+=b*M}function c(){if(f){var i,h=f.length,g=t.length,w=new Map(f.map((v,N)=>[e(v,N,f),v])),r;for(i=0,p=new Array(h);i<g;++i)r=t[i],r.index=i,typeof r.source!="object"&&(r.source=P(w,r.source)),typeof r.target!="object"&&(r.target=P(w,r.target)),p[r.source.index]=(p[r.source.index]||0)+1,p[r.target.index]=(p[r.target.index]||0)+1;for(i=0,y=new Array(g);i<g;++i)r=t[i],y[i]=p[r.source.index]/(p[r.source.index]+p[r.target.index]);l=new Array(g),_(),o=new Array(g),u()}}function _(){if(f)for(var i=0,h=t.length;i<h;++i)l[i]=+n(t[i],i,t)}function u(){if(f)for(var i=0,h=t.length;i<h;++i)o[i]=+a(t[i],i,t)}return x.initialize=function(i,h){f=i,s=h,c()},x.links=function(i){return arguments.length?(t=i,c(),x):t},x.id=function(i){return arguments.length?(e=i,x):e},x.iterations=function(i){return arguments.length?(d=+i,x):d},x.strength=function(i){return arguments.length?(n=typeof i=="function"?i:B(+i),_(),x):n},x.distance=function(i){return arguments.length?(a=typeof i=="function"?i:B(+i),u(),x):a},x}const dt=1664525,xt=1013904223,O=4294967296;function yt(){let t=1;return()=>(t=(dt*t+xt)%O)/O}function vt(t){return t.x}function _t(t){return t.y}var mt=10,bt=Math.PI*(3-Math.sqrt(5));function wt(t){var e,n=1,l=.001,a=1-Math.pow(l,1/300),o=0,f=.6,p=new Map,y=G(m),s=Q("tick","end"),d=yt();t==null&&(t=[]);function m(){x(),s.call("tick",e),n<l&&(y.stop(),s.call("end",e))}function x(u){var i,h=t.length,g;u===void 0&&(u=1);for(var w=0;w<u;++w)for(n+=(o-n)*a,p.forEach(function(r){r(n)}),i=0;i<h;++i)g=t[i],g.fx==null?g.x+=g.vx*=f:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=f:(g.y=g.fy,g.vy=0);return e}function c(){for(var u=0,i=t.length,h;u<i;++u){if(h=t[u],h.index=u,h.fx!=null&&(h.x=h.fx),h.fy!=null&&(h.y=h.fy),isNaN(h.x)||isNaN(h.y)){var g=mt*Math.sqrt(.5+u),w=u*bt;h.x=g*Math.cos(w),h.y=g*Math.sin(w)}(isNaN(h.vx)||isNaN(h.vy))&&(h.vx=h.vy=0)}}function _(u){return u.initialize&&u.initialize(t,d),u}return c(),e={tick:x,restart:function(){return y.restart(m),e},stop:function(){return y.stop(),e},nodes:function(u){return arguments.length?(t=u,c(),p.forEach(_),e):t},alpha:function(u){return arguments.length?(n=+u,e):n},alphaMin:function(u){return arguments.length?(l=+u,e):l},alphaDecay:function(u){return arguments.length?(a=+u,e):+a},alphaTarget:function(u){return arguments.length?(o=+u,e):o},velocityDecay:function(u){return arguments.length?(f=1-u,e):1-f},randomSource:function(u){return arguments.length?(d=u,p.forEach(_),e):d},force:function(u,i){return arguments.length>1?(i==null?p.delete(u):p.set(u,_(i)),e):p.get(u)},find:function(u,i,h){var g=0,w=t.length,r,v,N,A,b;for(h==null?h=1/0:h*=h,g=0;g<w;++g)A=t[g],r=u-A.x,v=i-A.y,N=r*r+v*v,N<h&&(b=A,h=N);return b},on:function(u,i){return arguments.length>1?(s.on(u,i),e):s.on(u)}}}function Nt(){var t,e,n,l,a=B(-30),o,f=1,p=1/0,y=.81;function s(c){var _,u=t.length,i=R(t,vt,_t).visitAfter(m);for(l=c,_=0;_<u;++_)e=t[_],i.visit(x)}function d(){if(t){var c,_=t.length,u;for(o=new Array(_),c=0;c<_;++c)u=t[c],o[u.index]=+a(u,c,t)}}function m(c){var _=0,u,i,h=0,g,w,r;if(c.length){for(g=w=r=0;r<4;++r)(u=c[r])&&(i=Math.abs(u.value))&&(_+=u.value,h+=i,g+=i*u.x,w+=i*u.y);c.x=g/h,c.y=w/h}else{u=c,u.x=u.data.x,u.y=u.data.y;do _+=o[u.data.index];while(u=u.next)}c.value=_}function x(c,_,u,i){if(!c.value)return!0;var h=c.x-e.x,g=c.y-e.y,w=i-_,r=h*h+g*g;if(w*w/y<r)return r<p&&(h===0&&(h=z(n),r+=h*h),g===0&&(g=z(n),r+=g*g),r<f&&(r=Math.sqrt(f*r)),e.vx+=h*c.value*l/r,e.vy+=g*c.value*l/r),!0;if(c.length||r>=p)return;(c.data!==e||c.next)&&(h===0&&(h=z(n),r+=h*h),g===0&&(g=z(n),r+=g*g),r<f&&(r=Math.sqrt(f*r)));do c.data!==e&&(w=o[c.data.index]*l/r,e.vx+=h*w,e.vy+=g*w);while(c=c.next)}return s.initialize=function(c,_){t=c,n=_,d()},s.strength=function(c){return arguments.length?(a=typeof c=="function"?c:B(+c),d(),s):a},s.distanceMin=function(c){return arguments.length?(f=c*c,s):Math.sqrt(f)},s.distanceMax=function(c){return arguments.length?(p=c*c,s):Math.sqrt(p)},s.theta=function(c){return arguments.length?(y=c*c,s):Math.sqrt(y)},s}const At=[{id:"hub",label:"NAMCS HC Component",detail:"EHR based encounter submissions powering microdata, dashboards, and linkage products for research",group:"hub"},{id:"microdata",label:"Microdata",detail:"Visit level datasets for analysis, public sample plus restricted detail files",group:"pillar"},{id:"dashboards",label:"Dashboards",detail:"Interactive preliminary estimates for people who do not want to code",group:"pillar"},{id:"linkage",label:"Linkage",detail:"Patient level links to external sources to add outcomes and social context",group:"pillar"},{id:"public_file",label:"Public file",detail:"Accessible microdata tier designed to lower cost and compute barriers",group:"sub"},{id:"restricted_file",label:"Restricted file",detail:"Secure microdata tier with broader detail and possible linked products",group:"sub"},{id:"biannual_prelim",label:"Biannual prelim",detail:"Periodic preliminary estimate cadence that improves timeliness",group:"sub"},{id:"download_tables",label:"Download tables",detail:"Exportable tables for reporting and sharing",group:"sub"},{id:"hud_link",label:"HUD link",detail:"Link to housing assistance participation to add social context",group:"sub"},{id:"ndi_link",label:"NDI link",detail:"Link to mortality records to enable downstream outcome analysis",group:"sub"}],Mt=[{source:"hub",target:"microdata",type:"partOf"},{source:"hub",target:"dashboards",type:"partOf"},{source:"hub",target:"linkage",type:"partOf"},{source:"microdata",target:"public_file",type:"contains"},{source:"microdata",target:"restricted_file",type:"contains"},{source:"dashboards",target:"biannual_prelim",type:"contains"},{source:"dashboards",target:"download_tables",type:"contains"},{source:"linkage",target:"hud_link",type:"contains"},{source:"linkage",target:"ndi_link",type:"contains"}],T={nodes:At,links:Mt};function $t(){const{ref:t,rect:e}=W(),n=L.useRef(null),l=L.useMemo(()=>{const a=T.nodes.map(f=>({...f})),o=T.links.map(f=>({...f}));return{nodes:a,links:o}},[]);return L.useEffect(()=>{const a=n.current;if(!a)return;const o=Math.max(860,e.width),f=Math.max(400,e.height-40);a.setAttribute("viewBox",`0 0 ${o} ${f}`);const p=C(a);p.selectAll("*").remove();const y=p.append("defs"),s={partOf:"#2F6FED",contains:"#2BB0A6",default:"#6B7280"};Object.entries(s).forEach(([r,v])=>{y.append("marker").attr("id",`arrow-${r}`).attr("viewBox","0 0 10 10").attr("refX",15).attr("refY",5).attr("markerWidth",2.5).attr("markerHeight",2.5).attr("orient","auto-start-reverse").append("path").attr("d","M0,0 L10,5 L0,10 L3,5 Z").attr("fill",v)});const d=l.nodes.map(r=>({...r})),m=l.links.map(r=>({...r})),x=wt(d).force("link",gt(m).id(r=>r.id).distance(r=>{const v=r.source,N=r.target,A=v.group,b=N.group;return A==="hub"||b==="hub"?170:A==="pillar"&&b==="sub"?115:140})).force("charge",Nt().strength(-520)).force("collide",ht().radius(r=>{const v=r;return v.group==="hub"?70:v.group==="pillar"?52:38})).force("center",X(o*.42,f*.52)),c=p.append("g").attr("class","links"),_=p.append("g").attr("class","nodes"),u=c.selectAll("path").data(m).join("path").attr("fill","none").attr("stroke",r=>s[r.type]||s.default).attr("stroke-width",2.5).attr("opacity",.4).attr("stroke-linecap","round").attr("marker-end",r=>`url(#arrow-${r.type||"default"})`),i=_.selectAll("g").data(d).join("g").style("cursor","pointer").on("mouseenter",function(){C(this).selectAll("circle").transition().duration(200).attr("r",function(){return parseFloat(C(this).attr("r"))*1.15})}).on("mouseleave",function(r,v){const N=v;C(this).select("circle.glow").transition().duration(200).attr("r",N.group==="hub"?72:N.group==="pillar"?56:44),C(this).select("circle:not(.glow)").transition().duration(200).attr("r",N.group==="hub"?60:N.group==="pillar"?44:32)});i.append("circle").attr("class","glow").attr("r",r=>r.group==="hub"?72:r.group==="pillar"?56:44).attr("fill",r=>r.group==="hub"?"#1F2A44":r.group==="pillar"?"#2F6FED":"#2BB0A6").attr("opacity",.12),i.append("circle").attr("r",r=>r.group==="hub"?60:r.group==="pillar"?44:32).attr("fill",r=>r.group==="hub"?"#1F2A44":r.group==="pillar"?"#2F6FED":"#FFFFFF").attr("stroke",r=>r.group==="sub"?"#E5E7EB":"white").attr("strokeWidth",r=>r.group==="sub"?2:3).style("filter","drop-shadow(0px 4px 6px rgba(0,0,0,0.1))");function h(r){return r.split(" ").map(v=>v===v.toUpperCase()&&v.length>1?v:v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" ")}function g(r,v){const N=r.split(" "),A=[];let b="";return N.forEach(k=>{const M=b?`${b} ${k}`:k;M.length<=v?b=M:(b&&A.push(b),b=k)}),b&&A.push(b),A}i.each(function(r){const v=r.group==="hub"?14:r.group==="pillar"?13:11,N=r.group==="hub"?12:r.group==="pillar"?10:9,A=h(r.label),b=g(A,N),k=1.4,M=C(this).append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size",v).attr("font-weight",r.group==="sub"?600:700).attr("fill",r.group==="hub"||r.group==="pillar"?"white":"#1F2A44").style("pointer-events","none");b.forEach((j,D)=>{const F=(D-(b.length-1)/2)*v*k;M.append("tspan").text(j).attr("x",0).attr("y",F)})});function w(r){const v=r.source,N=r.target,A=N.x-v.x,b=N.y-v.y,k=Math.sqrt(A*A+b*b)*1.1;return`M${v.x},${v.y} A${k},${k} 0 0,1 ${N.x},${N.y}`}return x.on("tick",()=>{u.attr("d",w),i.attr("transform",r=>`translate(${r.x}, ${r.y})`)}),()=>{x.stop()}},[l,e.width,e.height]),I.jsxs("div",{ref:t,style:{height:"100%",display:"flex",flexDirection:"column"},children:[I.jsx("svg",{ref:n,width:"100%",style:{flex:1,minHeight:0}}),I.jsx("div",{className:"small",style:{marginTop:10,flexShrink:0},children:"Hover or click nodes to explore the three pillars of NAMCS data"})]})}export{$t as default};
