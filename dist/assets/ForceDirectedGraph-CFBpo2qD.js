import{c as bt,d as Bt,e as Dt,f as Nt,a as Y,t as Wt,r as et,b as Lt,j as ct}from"./index-DisIoiRj.js";import{n as Xt,a as kt,d as Yt,b as vt,c as xt,y as Pt,p as At,z as Gt}from"./zoom-CqcNJepO.js";import{u as Ot}from"./useResizeObserver-IvLdvs2c.js";/* empty css                      */function Ft(t){return typeof t=="string"?new bt([document.querySelectorAll(t)],[document.documentElement]):new bt([Dt(t)],Bt)}const dt=t=>()=>t;function mt(t,{sourceEvent:e,subject:n,target:l,identifier:a,active:o,x:u,y:i,dx:h,dy:s,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:l,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:i,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:d}})}mt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Qt(t){return!t.ctrlKey&&!t.button}function Ut(){return this.parentNode}function Kt(t,e){return e??{x:t.x,y:t.y}}function Jt(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vt(){var t=Qt,e=Ut,n=Kt,l=Jt,a={},o=Nt("start","drag","end"),u=0,i,h,s,d,A=0;function y(r){r.on("mousedown.drag",p).filter(l).on("touchstart.drag",c).on("touchmove.drag",g,Xt).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(r,m){if(!(d||!t.call(this,r,m))){var k=$(this,e.call(this,r,m),r,m,"mouse");k&&(Y(r.view).on("mousemove.drag",w,kt).on("mouseup.drag",f,kt),Yt(r.view),vt(r),s=!1,i=r.clientX,h=r.clientY,k("start",r))}}function w(r){if(xt(r),!s){var m=r.clientX-i,k=r.clientY-h;s=m*m+k*k>A}a.mouse("drag",r)}function f(r){Y(r.view).on("mousemove.drag mouseup.drag",null),Pt(r.view,s),xt(r),a.mouse("end",r)}function c(r,m){if(t.call(this,r,m)){var k=r.changedTouches,T=e.call(this,r,m),M=k.length,C,j;for(C=0;C<M;++C)(j=$(this,T,r,m,k[C].identifier,k[C]))&&(vt(r),j("start",r,k[C]))}}function g(r){var m=r.changedTouches,k=m.length,T,M;for(T=0;T<k;++T)(M=a[m[T].identifier])&&(xt(r),M("drag",r,m[T]))}function x(r){var m=r.changedTouches,k=m.length,T,M;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),T=0;T<k;++T)(M=a[m[T].identifier])&&(vt(r),M("end",r,m[T]))}function $(r,m,k,T,M,C){var j=o.copy(),L=At(C||k,m),F,X,U;if((U=n.call(r,new mt("beforestart",{sourceEvent:k,target:y,identifier:M,active:u,x:L[0],y:L[1],dx:0,dy:0,dispatch:j}),T))!=null)return F=U.x-L[0]||0,X=U.y-L[1]||0,function J(V,tt,ut){var ot=L,nt;switch(V){case"start":a[M]=J,nt=u++;break;case"end":delete a[M],--u;case"drag":L=At(ut||tt,m),nt=u;break}j.call(V,r,new mt(V,{sourceEvent:tt,subject:U,target:y,identifier:M,active:nt,x:L[0]+F,y:L[1]+X,dx:L[0]-ot[0],dy:L[1]-ot[1],dispatch:j}),T)}}return y.filter=function(r){return arguments.length?(t=typeof r=="function"?r:dt(!!r),y):t},y.container=function(r){return arguments.length?(e=typeof r=="function"?r:dt(r),y):e},y.subject=function(r){return arguments.length?(n=typeof r=="function"?r:dt(r),y):n},y.touchable=function(r){return arguments.length?(l=typeof r=="function"?r:dt(!!r),y):l},y.on=function(){var r=o.on.apply(o,arguments);return r===o?y:r},y.clickDistance=function(r){return arguments.length?(A=(r=+r)*r,y):Math.sqrt(A)},y}function Zt(t,e){var n,l=1;t==null&&(t=0),e==null&&(e=0);function a(){var o,u=n.length,i,h=0,s=0;for(o=0;o<u;++o)i=n[o],h+=i.x,s+=i.y;for(h=(h/u-t)*l,s=(s/u-e)*l,o=0;o<u;++o)i=n[o],i.x-=h,i.y-=s}return a.initialize=function(o){n=o},a.x=function(o){return arguments.length?(t=+o,a):t},a.y=function(o){return arguments.length?(e=+o,a):e},a.strength=function(o){return arguments.length?(l=+o,a):l},a}function qt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Tt(this.cover(e,n),e,n,t)}function Tt(t,e,n,l){if(isNaN(e)||isNaN(n))return t;var a,o=t._root,u={data:l},i=t._x0,h=t._y0,s=t._x1,d=t._y1,A,y,p,w,f,c,g,x;if(!o)return t._root=u,t;for(;o.length;)if((f=e>=(A=(i+s)/2))?i=A:s=A,(c=n>=(y=(h+d)/2))?h=y:d=y,a=o,!(o=o[g=c<<1|f]))return a[g]=u,t;if(p=+t._x.call(null,o.data),w=+t._y.call(null,o.data),e===p&&n===w)return u.next=o,a?a[g]=u:t._root=u,t;do a=a?a[g]=new Array(4):t._root=new Array(4),(f=e>=(A=(i+s)/2))?i=A:s=A,(c=n>=(y=(h+d)/2))?h=y:d=y;while((g=c<<1|f)===(x=(w>=y)<<1|p>=A));return a[x]=o,a[g]=u,t}function Ht(t){var e,n,l=t.length,a,o,u=new Array(l),i=new Array(l),h=1/0,s=1/0,d=-1/0,A=-1/0;for(n=0;n<l;++n)isNaN(a=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(u[n]=a,i[n]=o,a<h&&(h=a),a>d&&(d=a),o<s&&(s=o),o>A&&(A=o));if(h>d||s>A)return this;for(this.cover(h,s).cover(d,A),n=0;n<l;++n)Tt(this,u[n],i[n],t[n]);return this}function te(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,l=this._y0,a=this._x1,o=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,o=(l=Math.floor(e))+1;else{for(var u=a-n||1,i=this._root,h,s;n>t||t>=a||l>e||e>=o;)switch(s=(e<l)<<1|t<n,h=new Array(4),h[s]=i,i=h,u*=2,s){case 0:a=n+u,o=l+u;break;case 1:n=a-u,o=l+u;break;case 2:a=n+u,l=o-u;break;case 3:n=a-u,l=o-u;break}this._root&&this._root.length&&(this._root=i)}return this._x0=n,this._y0=l,this._x1=a,this._y1=o,this}function ee(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function ne(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function P(t,e,n,l,a){this.node=t,this.x0=e,this.y0=n,this.x1=l,this.y1=a}function re(t,e,n){var l,a=this._x0,o=this._y0,u,i,h,s,d=this._x1,A=this._y1,y=[],p=this._root,w,f;for(p&&y.push(new P(p,a,o,d,A)),n==null?n=1/0:(a=t-n,o=e-n,d=t+n,A=e+n,n*=n);w=y.pop();)if(!(!(p=w.node)||(u=w.x0)>d||(i=w.y0)>A||(h=w.x1)<a||(s=w.y1)<o))if(p.length){var c=(u+h)/2,g=(i+s)/2;y.push(new P(p[3],c,g,h,s),new P(p[2],u,g,c,s),new P(p[1],c,i,h,g),new P(p[0],u,i,c,g)),(f=(e>=g)<<1|t>=c)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-f],y[y.length-1-f]=w)}else{var x=t-+this._x.call(null,p.data),$=e-+this._y.call(null,p.data),r=x*x+$*$;if(r<n){var m=Math.sqrt(n=r);a=t-m,o=e-m,d=t+m,A=e+m,l=p.data}}return l}function ie(t){if(isNaN(d=+this._x.call(null,t))||isNaN(A=+this._y.call(null,t)))return this;var e,n=this._root,l,a,o,u=this._x0,i=this._y0,h=this._x1,s=this._y1,d,A,y,p,w,f,c,g;if(!n)return this;if(n.length)for(;;){if((w=d>=(y=(u+h)/2))?u=y:h=y,(f=A>=(p=(i+s)/2))?i=p:s=p,e=n,!(n=n[c=f<<1|w]))return this;if(!n.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(l=e,g=c)}for(;n.data!==t;)if(a=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,a?(o?a.next=o:delete a.next,this):e?(o?e[c]=o:delete e[c],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(l?l[g]=n:this._root=n),this):(this._root=o,this)}function oe(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function ae(){return this._root}function se(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function le(t){var e=[],n,l=this._root,a,o,u,i,h;for(l&&e.push(new P(l,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(l=n.node,o=n.x0,u=n.y0,i=n.x1,h=n.y1)&&l.length){var s=(o+i)/2,d=(u+h)/2;(a=l[3])&&e.push(new P(a,s,d,i,h)),(a=l[2])&&e.push(new P(a,o,d,s,h)),(a=l[1])&&e.push(new P(a,s,u,i,d)),(a=l[0])&&e.push(new P(a,o,u,s,d))}return this}function ce(t){var e=[],n=[],l;for(this._root&&e.push(new P(this._root,this._x0,this._y0,this._x1,this._y1));l=e.pop();){var a=l.node;if(a.length){var o,u=l.x0,i=l.y0,h=l.x1,s=l.y1,d=(u+h)/2,A=(i+s)/2;(o=a[0])&&e.push(new P(o,u,i,d,A)),(o=a[1])&&e.push(new P(o,d,i,h,A)),(o=a[2])&&e.push(new P(o,u,A,d,s)),(o=a[3])&&e.push(new P(o,d,A,h,s))}n.push(l)}for(;l=n.pop();)t(l.node,l.x0,l.y0,l.x1,l.y1);return this}function ue(t){return t[0]}function fe(t){return arguments.length?(this._x=t,this):this._x}function he(t){return t[1]}function pe(t){return arguments.length?(this._y=t,this):this._y}function wt(t,e,n){var l=new _t(e??ue,n??he,NaN,NaN,NaN,NaN);return t==null?l:l.addAll(t)}function _t(t,e,n,l,a,o){this._x=t,this._y=e,this._x0=n,this._y0=l,this._x1=a,this._y1=o,this._root=void 0}function $t(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var O=wt.prototype=_t.prototype;O.copy=function(){var t=new _t(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,l;if(!e)return t;if(!e.length)return t._root=$t(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var a=0;a<4;++a)(l=e.source[a])&&(l.length?n.push({source:l,target:e.target[a]=new Array(4)}):e.target[a]=$t(l));return t};O.add=qt;O.addAll=Ht;O.cover=te;O.data=ee;O.extent=ne;O.find=re;O.remove=ie;O.removeAll=oe;O.root=ae;O.size=se;O.visit=le;O.visitAfter=ce;O.x=fe;O.y=pe;function G(t){return function(){return t}}function H(t){return(t()-.5)*1e-6}function ge(t){return t.x+t.vx}function de(t){return t.y+t.vy}function ye(t){var e,n,l,a=1,o=1;typeof t!="function"&&(t=G(t==null?1:+t));function u(){for(var s,d=e.length,A,y,p,w,f,c,g=0;g<o;++g)for(A=wt(e,ge,de).visitAfter(i),s=0;s<d;++s)y=e[s],f=n[y.index],c=f*f,p=y.x+y.vx,w=y.y+y.vy,A.visit(x);function x($,r,m,k,T){var M=$.data,C=$.r,j=f+C;if(M){if(M.index>y.index){var L=p-M.x-M.vx,F=w-M.y-M.vy,X=L*L+F*F;X<j*j&&(L===0&&(L=H(l),X+=L*L),F===0&&(F=H(l),X+=F*F),X=(j-(X=Math.sqrt(X)))/X*a,y.vx+=(L*=X)*(j=(C*=C)/(c+C)),y.vy+=(F*=X)*j,M.vx-=L*(j=1-j),M.vy-=F*j)}return}return r>p+j||k<p-j||m>w+j||T<w-j}}function i(s){if(s.data)return s.r=n[s.data.index];for(var d=s.r=0;d<4;++d)s[d]&&s[d].r>s.r&&(s.r=s[d].r)}function h(){if(e){var s,d=e.length,A;for(n=new Array(d),s=0;s<d;++s)A=e[s],n[A.index]=+t(A,s,e)}}return u.initialize=function(s,d){e=s,l=d,h()},u.iterations=function(s){return arguments.length?(o=+s,u):o},u.strength=function(s){return arguments.length?(a=+s,u):a},u.radius=function(s){return arguments.length?(t=typeof s=="function"?s:G(+s),h(),u):t},u}function ve(t){return t.index}function Mt(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function xe(t){var e=ve,n=A,l,a=G(30),o,u,i,h,s,d=1;t==null&&(t=[]);function A(c){return 1/Math.min(i[c.source.index],i[c.target.index])}function y(c){for(var g=0,x=t.length;g<d;++g)for(var $=0,r,m,k,T,M,C,j;$<x;++$)r=t[$],m=r.source,k=r.target,T=k.x+k.vx-m.x-m.vx||H(s),M=k.y+k.vy-m.y-m.vy||H(s),C=Math.sqrt(T*T+M*M),C=(C-o[$])/C*c*l[$],T*=C,M*=C,k.vx-=T*(j=h[$]),k.vy-=M*j,m.vx+=T*(j=1-j),m.vy+=M*j}function p(){if(u){var c,g=u.length,x=t.length,$=new Map(u.map((m,k)=>[e(m,k,u),m])),r;for(c=0,i=new Array(g);c<x;++c)r=t[c],r.index=c,typeof r.source!="object"&&(r.source=Mt($,r.source)),typeof r.target!="object"&&(r.target=Mt($,r.target)),i[r.source.index]=(i[r.source.index]||0)+1,i[r.target.index]=(i[r.target.index]||0)+1;for(c=0,h=new Array(x);c<x;++c)r=t[c],h[c]=i[r.source.index]/(i[r.source.index]+i[r.target.index]);l=new Array(x),w(),o=new Array(x),f()}}function w(){if(u)for(var c=0,g=t.length;c<g;++c)l[c]=+n(t[c],c,t)}function f(){if(u)for(var c=0,g=t.length;c<g;++c)o[c]=+a(t[c],c,t)}return y.initialize=function(c,g){u=c,s=g,p()},y.links=function(c){return arguments.length?(t=c,p(),y):t},y.id=function(c){return arguments.length?(e=c,y):e},y.iterations=function(c){return arguments.length?(d=+c,y):d},y.strength=function(c){return arguments.length?(n=typeof c=="function"?c:G(+c),w(),y):n},y.distance=function(c){return arguments.length?(a=typeof c=="function"?c:G(+c),f(),y):a},y}const me=1664525,we=1013904223,Rt=4294967296;function _e(){let t=1;return()=>(t=(me*t+we)%Rt)/Rt}function be(t){return t.x}function ke(t){return t.y}var Ae=10,$e=Math.PI*(3-Math.sqrt(5));function Me(t){var e,n=1,l=.001,a=1-Math.pow(l,1/300),o=0,u=.6,i=new Map,h=Wt(A),s=Nt("tick","end"),d=_e();t==null&&(t=[]);function A(){y(),s.call("tick",e),n<l&&(h.stop(),s.call("end",e))}function y(f){var c,g=t.length,x;f===void 0&&(f=1);for(var $=0;$<f;++$)for(n+=(o-n)*a,i.forEach(function(r){r(n)}),c=0;c<g;++c)x=t[c],x.fx==null?x.x+=x.vx*=u:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=u:(x.y=x.fy,x.vy=0);return e}function p(){for(var f=0,c=t.length,g;f<c;++f){if(g=t[f],g.index=f,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var x=Ae*Math.sqrt(.5+f),$=f*$e;g.x=x*Math.cos($),g.y=x*Math.sin($)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function w(f){return f.initialize&&f.initialize(t,d),f}return p(),e={tick:y,restart:function(){return h.restart(A),e},stop:function(){return h.stop(),e},nodes:function(f){return arguments.length?(t=f,p(),i.forEach(w),e):t},alpha:function(f){return arguments.length?(n=+f,e):n},alphaMin:function(f){return arguments.length?(l=+f,e):l},alphaDecay:function(f){return arguments.length?(a=+f,e):+a},alphaTarget:function(f){return arguments.length?(o=+f,e):o},velocityDecay:function(f){return arguments.length?(u=1-f,e):1-u},randomSource:function(f){return arguments.length?(d=f,i.forEach(w),e):d},force:function(f,c){return arguments.length>1?(c==null?i.delete(f):i.set(f,w(c)),e):i.get(f)},find:function(f,c,g){var x=0,$=t.length,r,m,k,T,M;for(g==null?g=1/0:g*=g,x=0;x<$;++x)T=t[x],r=f-T.x,m=c-T.y,k=r*r+m*m,k<g&&(M=T,g=k);return M},on:function(f,c){return arguments.length>1?(s.on(f,c),e):s.on(f)}}}function Re(){var t,e,n,l,a=G(-30),o,u=1,i=1/0,h=.81;function s(p){var w,f=t.length,c=wt(t,be,ke).visitAfter(A);for(l=p,w=0;w<f;++w)e=t[w],c.visit(y)}function d(){if(t){var p,w=t.length,f;for(o=new Array(w),p=0;p<w;++p)f=t[p],o[f.index]=+a(f,p,t)}}function A(p){var w=0,f,c,g=0,x,$,r;if(p.length){for(x=$=r=0;r<4;++r)(f=p[r])&&(c=Math.abs(f.value))&&(w+=f.value,g+=c,x+=c*f.x,$+=c*f.y);p.x=x/g,p.y=$/g}else{f=p,f.x=f.data.x,f.y=f.data.y;do w+=o[f.data.index];while(f=f.next)}p.value=w}function y(p,w,f,c){if(!p.value)return!0;var g=p.x-e.x,x=p.y-e.y,$=c-w,r=g*g+x*x;if($*$/h<r)return r<i&&(g===0&&(g=H(n),r+=g*g),x===0&&(x=H(n),r+=x*x),r<u&&(r=Math.sqrt(u*r)),e.vx+=g*p.value*l/r,e.vy+=x*p.value*l/r),!0;if(p.length||r>=i)return;(p.data!==e||p.next)&&(g===0&&(g=H(n),r+=g*g),x===0&&(x=H(n),r+=x*x),r<u&&(r=Math.sqrt(u*r)));do p.data!==e&&($=o[p.data.index]*l/r,e.vx+=g*$,e.vy+=x*$);while(p=p.next)}return s.initialize=function(p,w){t=p,n=w,d()},s.strength=function(p){return arguments.length?(a=typeof p=="function"?p:G(+p),d(),s):a},s.distanceMin=function(p){return arguments.length?(u=p*p,s):Math.sqrt(u)},s.distanceMax=function(p){return arguments.length?(i=p*p,s):Math.sqrt(i)},s.theta=function(p){return arguments.length?(h=p*p,s):Math.sqrt(h)},s}function Ne(t){var e=G(.1),n,l,a;typeof t!="function"&&(t=G(t==null?0:+t));function o(i){for(var h=0,s=n.length,d;h<s;++h)d=n[h],d.vx+=(a[h]-d.x)*l[h]*i}function u(){if(n){var i,h=n.length;for(l=new Array(h),a=new Array(h),i=0;i<h;++i)l[i]=isNaN(a[i]=+t(n[i],i,n))?0:+e(n[i],i,n)}}return o.initialize=function(i){n=i,u()},o.strength=function(i){return arguments.length?(e=typeof i=="function"?i:G(+i),u(),o):e},o.x=function(i){return arguments.length?(t=typeof i=="function"?i:G(+i),u(),o):t},o}function Te(t){var e=G(.1),n,l,a;typeof t!="function"&&(t=G(t==null?0:+t));function o(i){for(var h=0,s=n.length,d;h<s;++h)d=n[h],d.vy+=(a[h]-d.y)*l[h]*i}function u(){if(n){var i,h=n.length;for(l=new Array(h),a=new Array(h),i=0;i<h;++i)l[i]=isNaN(a[i]=+t(n[i],i,n))?0:+e(n[i],i,n)}}return o.initialize=function(i){n=i,u()},o.strength=function(i){return arguments.length?(e=typeof i=="function"?i:G(+i),u(),o):e},o.y=function(i){return arguments.length?(t=typeof i=="function"?i:G(+i),u(),o):t},o}const ze={baseColor:"#A4B6C1",baseWidth:20,baseOpacity:.6,overlayWidth:12,overlayOpacity:.5,colors:{partOf:"#244855",contains:"#E64833",default:"#90AEAD"}},Se={linkDistance:(t,e)=>t==="hub"||e==="hub"?255:t==="pillar"&&e==="sub"?173:210,chargeStrength:-520,collisionStrength:1,collisionIterations:3,centerStrength:{x:.1,y:.1}},Ee={keys:["who","what","when","where","why","which","how"],questionMap:{who:"Who is involved?",what:"What is it?",when:"When does it occur?",where:"Where does it happen?",why:"Why does it matter?",which:"Which options are available?",how:"How does it work?"},distance:30,radius:16,glowRadius:20,fontSize:9,strokeWidth:2},je={scaleExtent:[.1,4],initialScale:.85,initialTranslate:{x:.1,y:.08},transitionDuration:750};function yt(t,e){return e?{...t,...e}:t}function We({data:t,nodeGroupConfigs:e,linkStyleConfig:n,forceConfig:l,satelliteConfig:a,zoomConfig:o,minWidth:u=860,minHeight:i=400,enableDrag:h=!0,enableZoom:s=!0,enableSatellites:d=!0,popoverClassName:A,tooltipClassName:y,onNodeClick:p,onNodeHover:w}){const{ref:f,rect:c}=Ot(),g=et.useRef(null),x=et.useRef(null),$=et.useRef(null),r=et.useRef(null),m=et.useRef(null),k=yt(ze,n),T=yt(Se,l),M=yt(Ee,a),C=yt(je,o),j=et.useMemo(()=>{const X=t.nodes.map(J=>({...J})),U=t.links.map(J=>({...J}));return{nodes:X,links:U}},[t]);et.useEffect(()=>{const X=g.current;if(!X)return;const U=Math.max(u,c.width),J=Math.max(i,c.height);X.setAttribute("viewBox",`0 0 ${U} ${J}`);const V=Y(X);V.selectAll("*").remove();const tt=V.append("g").attr("class","zoom-container"),ut=V.append("defs");Object.entries(e).forEach(([v,_])=>{const b=ut.append("linearGradient").attr("id",`${v}Gradient`).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");_.gradient.forEach((I,N)=>{b.append("stop").attr("offset",`${N/(_.gradient.length-1)*100}%`).attr("stop-color",I)});const R=ut.append("linearGradient").attr("id",`${v}SatelliteGradient`).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");_.satelliteGradient.forEach((I,N)=>{R.append("stop").attr("offset",`${N/(_.satelliteGradient.length-1)*100}%`).attr("stop-color",I)})});const ot=j.nodes.map(v=>({...v})),nt=j.links.map(v=>({...v})),ft=Me(ot).force("link",xe(nt).id(v=>v.id).distance(v=>{const _=v.source,b=v.target;return T.linkDistance(_.group,b.group)})).force("charge",Re().strength(T.chargeStrength)).force("collide",ye().radius(v=>{const b=e[v.group];return b?b.collisionRadius:50}).strength(T.collisionStrength).iterations(T.collisionIterations)).force("center",Zt(U*.5,J*.5)).force("x",Ne(U*.5).strength(T.centerStrength.x)).force("y",Te(J*.5).strength(T.centerStrength.y));if(s){const v=Gt().scaleExtent(C.scaleExtent).on("zoom",b=>{tt.attr("transform",b.transform)});V.call(v);const _=Lt.translate(U*C.initialTranslate.x,J*C.initialTranslate.y).scale(C.initialScale);V.call(v.transform,_),V.on("dblclick.zoom",()=>{V.transition().duration(C.transitionDuration).call(v.transform,_)})}const zt=tt.append("g").attr("class","links"),St=tt.append("g").attr("class","nodes"),Z=tt.append("g").attr("class","satellites"),at=zt.selectAll("g.link").data(nt).join("g").attr("class","link");at.append("path").attr("class","link-base").attr("fill","none").attr("stroke",k.baseColor).attr("stroke-width",k.baseWidth).attr("opacity",k.baseOpacity).attr("stroke-linecap","round"),at.append("path").attr("class","link-overlay").attr("fill","none").attr("stroke",v=>k.colors[v.type||"default"]||k.colors.default).attr("stroke-width",k.overlayWidth).attr("opacity",k.overlayOpacity).attr("stroke-linecap","round"),at.append("path").attr("class","link-hover-target").attr("fill","none").attr("stroke","transparent").attr("stroke-width",20).style("cursor","pointer"),at.on("mouseenter",function(v,_){const b=r.current,R=f.current;if(!b||!R)return;const I=$.current;I&&(I.style.display="none");const N=_.source,S=_.target,W=_.relationship||_.type||"connects to",E=_.description||`${N.label} ${W.toLowerCase()} ${S.label}`;b.innerHTML=`
          <div class="force-directed-graph__link-popover-header">
            <span class="force-directed-graph__link-popover-source">${N.label}</span>
            <span class="force-directed-graph__link-popover-arrow">â†’</span>
            <span class="force-directed-graph__link-popover-target">${S.label}</span>
          </div>
          <div class="force-directed-graph__link-popover-relationship">${W}</div>
          <div class="force-directed-graph__link-popover-description">${E}</div>
        `,b.style.display="block";const B=R.getBoundingClientRect(),D=b.getBoundingClientRect(),z=15,Q=10;let K=v.pageX-B.left+z,q=v.pageY-B.top+z;K+D.width>B.width-Q&&(K=v.pageX-B.left-D.width-z),q+D.height>B.height-Q&&(q=v.pageY-B.top-D.height-z),K<Q&&(K=Q),q<Q&&(q=Q),b.style.left=K+"px",b.style.top=q+"px",Y(this).select(".link-overlay").transition().duration(200).attr("stroke-width",k.overlayWidth*2).attr("opacity",1),Y(this).select(".link-base").transition().duration(200).attr("stroke-width",k.baseWidth*1.5)}).on("mousemove",function(v){const _=r.current,b=f.current;if(!_||!b)return;const R=b.getBoundingClientRect(),I=_.getBoundingClientRect(),N=15,S=10;let W=v.pageX-R.left+N,E=v.pageY-R.top+N;W+I.width>R.width-S&&(W=v.pageX-R.left-I.width-N),E+I.height>R.height-S&&(E=v.pageY-R.top-I.height-N),W<S&&(W=S),E<S&&(E=S),_.style.left=W+"px",_.style.top=E+"px"}).on("mouseleave",function(){const v=r.current;v&&(v.style.display="none"),Y(this).select(".link-overlay").transition().duration(200).attr("stroke-width",k.overlayWidth).attr("opacity",k.overlayOpacity),Y(this).select(".link-base").transition().duration(200).attr("stroke-width",k.baseWidth)});function Et(v){if(!d)return;m.current&&(clearTimeout(m.current),m.current=null),Z.selectAll("*").remove();const _=x.current;_&&(_.style.display="none");const b=M.keys.filter(z=>v[z]&&String(v[z]).trim().length>0);if(b.length===0)return;const R=e[v.group];if(!R)return;const I=R.glowRadius+M.distance,N=Math.PI*2/b.length,S=v.x||U/2,W=v.y||J/2,E=b.map((z,Q)=>({key:z,label:z,text:String(v[z]||""),x:S+I*Math.cos(Q*N-Math.PI/2),y:W+I*Math.sin(Q*N-Math.PI/2)})),B=`${v.group}SatelliteGradient`;Z.selectAll("line.satellite-connector").data(E).join("line").attr("class","satellite-connector").attr("x1",S).attr("y1",W).attr("x2",z=>z.x).attr("y2",z=>z.y).attr("stroke",`url(#${B})`).attr("stroke-width",M.strokeWidth).attr("opacity",.4).attr("stroke-dasharray","4,4");const D=Z.selectAll("g.satellite").data(E).join("g").attr("class","satellite").attr("transform",z=>`translate(${z.x},${z.y})`).style("cursor","pointer");D.append("circle").attr("r",M.glowRadius).attr("fill",`url(#${B})`).attr("opacity",.25),D.append("circle").attr("r",M.radius).attr("fill",`url(#${B})`).attr("opacity",.85).attr("stroke",R.stroke).attr("stroke-width",M.strokeWidth).style("filter","drop-shadow(0px 4px 8px rgba(36, 72, 85, 0.3))"),D.append("text").attr("text-anchor","middle").attr("dy",4).attr("font-size",M.fontSize).attr("font-weight",700).attr("font-family",'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif').attr("fill","#ffffff").style("pointer-events","none").style("text-shadow","0px 1px 3px rgba(0,0,0,0.5)").style("letter-spacing","0.3px").text(z=>z.label.charAt(0).toUpperCase()+z.label.slice(1).toLowerCase()),D.on("mouseenter",(z,Q)=>{m.current&&(clearTimeout(m.current),m.current=null);const K=x.current,q=f.current;if(!K||!q)return;const It=M.questionMap[Q.key]||Q.key;K.innerHTML=`
          <div class="force-directed-graph__tooltip-question">${It}</div>
          <div class="force-directed-graph__tooltip-answer">${Q.text}</div>
        `,K.style.display="block";const rt=q.getBoundingClientRect(),pt=K.getBoundingClientRect(),gt=15,it=10;let st=z.pageX-rt.left+gt,lt=z.pageY-rt.top+gt;st+pt.width>rt.width-it&&(st=z.pageX-rt.left-pt.width-gt),lt+pt.height>rt.height-it&&(lt=z.pageY-rt.top-pt.height-gt),st<it&&(st=it),lt<it&&(lt=it),K.style.left=st+"px",K.style.top=lt+"px",Y(z.currentTarget).select("circle:nth-child(2)").transition().duration(200).attr("r",M.radius+2)}),D.on("mouseleave",()=>{const z=x.current;z&&(z.style.display="none"),Ft(".satellite circle:nth-child(2)").transition().duration(200).attr("r",M.radius)}),Z.on("mouseenter",()=>{m.current&&(clearTimeout(m.current),m.current=null)}),Z.on("mouseleave",()=>{m.current=window.setTimeout(()=>{Z.selectAll("*").remove();const z=x.current;z&&(z.style.display="none")},100)})}const jt=Vt().on("start",function(v,_){v.active||ft.alphaTarget(.3).restart(),_.fx=_.x,_.fy=_.y,Y(this).style("cursor","grabbing"),Z.selectAll("*").remove();const b=x.current;b&&(b.style.display="none");const R=$.current;R&&(R.style.display="none")}).on("drag",function(v,_){_.fx=v.x,_.fy=v.y}).on("end",function(v,_){v.active||ft.alphaTarget(0),Y(this).style("cursor","grab")}),ht=St.selectAll("g").data(ot).join("g").attr("class","node").style("cursor",h?"grab":"pointer");h&&ht.call(jt),ht.on("mouseenter",function(v,_){m.current&&(clearTimeout(m.current),m.current=null),Y(this).selectAll("circle").transition().duration(200).attr("r",function(){return parseFloat(Y(this).attr("r"))*1.15});const b=_;Et(b),w&&w(b);const R=$.current;if(R&&b.detail){R.innerHTML=`
            <div class="force-directed-graph__popover-title">${b.label}</div>
            <div class="force-directed-graph__popover-content">${b.detail}</div>
          `,R.style.display="block";const I=f.current;if(I){const N=I.getBoundingClientRect(),S=R.getBoundingClientRect(),W=15,E=10;let B=v.pageX-N.left+W,D=v.pageY-N.top+W;B+S.width>N.width-E&&(B=v.pageX-N.left-S.width-W),D+S.height>N.height-E&&(D=v.pageY-N.top-S.height-W),B<E&&(B=E),D<E&&(D=E),R.style.left=B+"px",R.style.top=D+"px"}}}).on("mousemove",function(v,_){const b=$.current,R=f.current;if(b&&_.detail&&R){const N=R.getBoundingClientRect(),S=b.getBoundingClientRect(),W=15,E=10;let B=v.pageX-N.left+W,D=v.pageY-N.top+W;B+S.width>N.width-E&&(B=v.pageX-N.left-S.width-W),D+S.height>N.height-E&&(D=v.pageY-N.top-S.height-W),B<E&&(B=E),D<E&&(D=E),b.style.left=B+"px",b.style.top=D+"px"}}).on("mouseleave",function(v,_){const R=e[_.group];R&&(Y(this).select("circle.glow").transition().duration(200).attr("r",R.glowRadius),Y(this).select("circle:not(.glow)").transition().duration(200).attr("r",R.radius));const I=$.current;I&&(I.style.display="none"),w&&w(null),m.current=window.setTimeout(()=>{Z.selectAll("*").remove();const N=x.current;N&&(N.style.display="none")},100)}).on("click",(v,_)=>{p&&p(_)}),ht.each(function(v){const _=v,b=e[_.group];if(!b)return;const R=Y(this);R.append("circle").attr("class","glow").attr("r",b.glowRadius).attr("fill",`url(#${_.group}Gradient)`).attr("opacity",.25),R.append("circle").attr("r",b.radius).attr("fill",`url(#${_.group}Gradient)`).attr("opacity",.85).attr("stroke",b.stroke).attr("stroke-width",3).style("filter","drop-shadow(0px 6px 12px rgba(36, 72, 85, 0.4))");const I=_.label.split(" "),N=[];let S="";I.forEach(E=>{const B=S?`${S} ${E}`:E;B.length<=b.maxChars?S=B:(S&&N.push(S),S=E)}),S&&N.push(S);const W=R.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size",b.fontSize).attr("font-weight",800).attr("font-family",'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif').attr("fill","white").style("pointer-events","none").style("text-shadow","0px 2px 6px rgba(0,0,0,0.5)").style("letter-spacing","0.3px");N.forEach((E,B)=>{const D=(B-(N.length-1)/2)*b.fontSize*1.4;W.append("tspan").text(E).attr("x",0).attr("y",D)})});function Ct(v){const _=v.source,b=v.target,R=b.x-_.x,I=b.y-_.y,N=Math.sqrt(R*R+I*I)*1.1;return`M${_.x},${_.y} A${N},${N} 0 0,1 ${b.x},${b.y}`}return ft.on("tick",()=>{at.selectAll("path").attr("d",Ct),ht.attr("transform",v=>`translate(${v.x}, ${v.y})`)}),()=>{ft.stop()}},[j,e,k,T,M,C,c.width,c.height,u,i,h,s,d,p,w]);const L=A?`force-directed-graph__popover ${A}`:"force-directed-graph__popover",F=y?`force-directed-graph__tooltip ${y}`:"force-directed-graph__tooltip";return ct.jsxs("div",{ref:f,className:"force-directed-graph",children:[ct.jsx("svg",{ref:g,width:"100%",height:"100%",className:"force-directed-graph__svg"}),ct.jsx("div",{ref:$,className:L}),ct.jsx("div",{ref:r,className:"force-directed-graph__link-popover"}),ct.jsx("div",{ref:x,className:F})]})}export{We as F};
